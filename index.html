<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Evento Directo</title>
<style>
  body, html {
    margin: 0;
    padding: 0;
    height: 100%;
    background-color: #fff;
    overflow: hidden;
  }
  #videoContainer {
    display: none;
    width: 100%;
    height: 100%;
    position: fixed;
    top: 0;
    left: 0;
    opacity: 0;
    transition: opacity 1.5s ease-in;
  }
  iframe {
    width: 100%;
    height: 100%;
    border: none;
  }
</style>
</head>
<body>
<div id="videoContainer">
  <iframe id="ytplayer" src="" allow="autoplay; fullscreen" allowfullscreen></iframe>
</div>

<script>
const videoContainer = document.getElementById('videoContainer');
const player = document.getElementById('ytplayer');
const videoId = '2HDnkwhz0Gk';
let started = false;

// FunciÃ³n para obtener la hora de inicio segÃºn el dÃ­a
function getEventStart(now) {
  const utc = now.getTime() + now.getTimezoneOffset() * 60000;
  const spainNow = new Date(utc + 2 * 3600000); // GMT+2
  const day = spainNow.getDay();
  const event = new Date(spainNow);

  const today = spainNow.getDate();

  // ðŸ”¹ Prueba solo hoy a 4:10 AM
  const testDay = today;
  if (today === testDay) {
    event.setHours(4,10,0,0);
    return event;
  }

  // ðŸ”¹ MiÃ©rcoles 17:00
  if (day === 3) {
    event.setHours(17,0,0,0);
    return event;
  }

  // ðŸ”¹ Domingo 23:30
  if (day === 0) {
    event.setHours(23,30,0,0);
    return event;
  }

  return null;
}

// Inicializa el video solo una vez
function startEvent() {
  const now = new Date();
  const eventStart = getEventStart(now);
  if (!eventStart) return;

  const utc = now.getTime() + now.getTimezoneOffset() * 60000;
  const spainNow = new Date(utc + 2 * 3600000);
  let diff = Math.floor((spainNow - eventStart)/1000);
  if (diff < 0) diff = 0;

  const embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&playsinline=1&controls=0&rel=0&modestbranding=1&start=${diff}`;
  player.src = embedUrl;

  videoContainer.style.display = 'block';
  setTimeout(()=>{videoContainer.style.opacity=1;},50);
}

// ComprobaciÃ³n cada segundo
function checkEvent() {
  if (started) return;
  const now = new Date();
  const eventStart = getEventStart(now);
  if (!eventStart) return;

  const utc = now.getTime() + now.getTimezoneOffset() * 60000;
  const spainNow = new Date(utc + 2 * 3600000);

  if (spainNow >= eventStart) {
    startEvent();
    started = true;
  }
}

setInterval(checkEvent,1000);
checkEvent();
</script>
</body>
</html>
