<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Evento Directo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #fff; /* Fondo blanco */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        #videoContainer {
            display: none; /* Invisible mientras no es hora */
            width: 100%;
            height: 100%;
            justify-content: center;
            align-items: center;
        }

        video {
            width: 100%;
            height: auto;
            max-height: 100%;
        }
    </style>
</head>
<body>
    <div id="videoContainer">
        <video id="eventVideo" src="eventovideo.mp4" playsinline muted></video>
    </div>

    <script>
        const videoContainer = document.getElementById("videoContainer");
        const video = document.getElementById("eventVideo");

        // Función para obtener la fecha de inicio del próximo evento en España
        function getNextEventStart(now) {
            const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
            const spainNow = new Date(utc + (2 * 3600000));

            const day = spainNow.getDay();
            const hours = spainNow.getHours();
            const minutes = spainNow.getMinutes();

            let eventDate;

            if (day === 3 && (hours < 17 || (hours === 17 && minutes < 0))) {
                // Hoy miércoles antes de las 17:00
                eventDate = new Date(spainNow);
                eventDate.setHours(17,0,0,0);
            } else if (day < 3) {
                // Próximo miércoles
                const daysUntilWed = (3 - day + 7) % 7;
                eventDate = new Date(spainNow);
                eventDate.setDate(spainNow.getDate() + daysUntilWed);
                eventDate.setHours(17,0,0,0);
            } else if (day === 0 && (hours < 23 || (hours === 23 && minutes < 30))) {
                // Domingo antes de las 23:30
                eventDate = new Date(spainNow);
                eventDate.setHours(23,30,0,0);
            } else if (day < 0 || day > 0 && day < 7) {
                // Próximo domingo
                const daysUntilSun = (7 - day) % 7;
                eventDate = new Date(spainNow);
                eventDate.setDate(spainNow.getDate() + daysUntilSun);
                eventDate.setHours(23,30,0,0);
            } else {
                // Hoy ya pasó el evento, buscamos próximo
                eventDate = new Date(spainNow);
            }

            return eventDate;
        }

        function checkEvent() {
            const now = new Date();
            const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
            const spainNow = new Date(utc + (2 * 3600000));

            // Eventos miércoles 17:00 y domingo 23:30
            const day = spainNow.getDay();
            const hour = spainNow.getHours();
            const minute = spainNow.getMinutes();

            let eventStart = null;

            if (day === 3 && (hour > 17 || (hour === 17 && minute >= 0))) {
                // Miércoles ya empezó el evento
                eventStart = new Date(spainNow);
                eventStart.setHours(17,0,0,0);
            } else if (day === 0 && (hour > 23 || (hour === 23 && minute >= 30))) {
                // Domingo ya empezó el evento
                eventStart = new Date(spainNow);
                eventStart.setHours(23,30,0,0);
            } else if (day === 3 && hour < 17) {
                eventStart = new Date(spainNow);
                eventStart.setHours(17,0,0,0);
            } else if (day === 0 && hour < 23) {
                eventStart = new Date(spainNow);
                eventStart.setHours(23,30,0,0);
            } else if (day === 1 || day === 2) { // lunes/martes
                // Próximo miércoles
                const daysUntilWed = (3 - day + 7) % 7;
                eventStart = new Date(spainNow);
                eventStart.setDate(spainNow.getDate() + daysUntilWed);
                eventStart.setHours(17,0,0,0);
            } else if (day === 4 || day === 5 || day === 6) { // jue/vi/sab
                // Próximo domingo
                const daysUntilSun = (7 - day) % 7;
                eventStart = new Date(spainNow);
                eventStart.setDate(spainNow.getDate() + daysUntilSun);
                eventStart.setHours(23,30,0,0);
            }

            if (!eventStart) return;

            const diff = spainNow - eventStart;

            if (diff >= 0 && diff < video.duration * 1000) {
                // Mostrar video y poner en tiempo real
                videoContainer.style.display = "flex";
                video.currentTime = diff / 1000;
                video.play().catch(e => console.log("Autoplay bloqueado:", e));
            } else {
                // No es hora de evento
                videoContainer.style.display = "none";
                video.pause();
            }
        }

        // Verificar cada 5 segundos
        setInterval(checkEvent, 5000);
        checkEvent();
    </script>
</body>
</html>
